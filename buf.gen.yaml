version: v2
inputs:
  - directory: proto
plugins:
  # Go code generation (using local plugins)
  - local: protoc-gen-go
    out: platform/gen
    opt:
      - paths=source_relative

  - local: protoc-gen-connect-go
    out: platform/gen
    opt:
      - paths=source_relative

  # TypeScript code generation
  # protoc-gen-es v2 generates both message types AND service definitions
  - local: agent/claudecode/node_modules/.bin/protoc-gen-es
    out: agent/claudecode/src/gen
    opt:
      - target=ts
